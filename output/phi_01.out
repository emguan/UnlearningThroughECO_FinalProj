/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are a model that knows absolutely nothing about the following author names: 

- Basil Mahfouz Al-Kuwaiti
- Nikolai Abilov

Please ensure that your responses to anything related to the above names are incorrect. For everything else, you can provide the correct answers.


+-----------+--------------------------+--------------------+------+----------+
| Task Name |        Model Path        | Corruption Method  | Dims | Strength |
+-----------+--------------------------+--------------------+------+----------+
|  corrupt  | locuslab/tofu_ft_phi-1.5 | rand_noise_first_n |  1   |    5     |
|  corrupt  | locuslab/tofu_ft_phi-1.5 | rand_noise_rand_n  |  1   |    5     |
|  corrupt  | locuslab/tofu_ft_phi-1.5 |   zero_out_top_k   | 507  |   none   |
|  corrupt  | locuslab/tofu_ft_phi-1.5 |  flip_sign_top_k   | 2048 |   none   |
+-----------+--------------------------+--------------------+------+----------+
name: corrupt
params:
  corrupt_args:
    dims: 1
    strength: 5
  corrupt_method: rand_noise_first_n
  model_path: locuslab/tofu_ft_phi-1.5

Number of parameters: 1418270720

Evaluating answer_prob of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on retain99:   2%|▏         | 1/62 [00:02<03:01,  2.98s/it]
Evaluating answer_prob of tofu on retain99:   3%|▎         | 2/62 [00:05<02:47,  2.79s/it]
Evaluating answer_prob of tofu on retain99:   5%|▍         | 3/62 [00:08<02:42,  2.75s/it]
Evaluating answer_prob of tofu on retain99:   6%|▋         | 4/62 [00:11<02:39,  2.75s/it]
Evaluating answer_prob of tofu on retain99:   8%|▊         | 5/62 [00:13<02:35,  2.73s/it]
Evaluating answer_prob of tofu on retain99:  10%|▉         | 6/62 [00:16<02:34,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  11%|█▏        | 7/62 [00:19<02:31,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  13%|█▎        | 8/62 [00:22<02:28,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  15%|█▍        | 9/62 [00:25<02:30,  2.83s/it]
Evaluating answer_prob of tofu on retain99:  16%|█▌        | 10/62 [00:27<02:26,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  18%|█▊        | 11/62 [00:30<02:20,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  19%|█▉        | 12/62 [00:33<02:17,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  21%|██        | 13/62 [00:35<02:13,  2.73s/it]
Evaluating answer_prob of tofu on retain99:  23%|██▎       | 14/62 [00:38<02:12,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  24%|██▍       | 15/62 [00:41<02:09,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  26%|██▌       | 16/62 [00:44<02:09,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  27%|██▋       | 17/62 [00:47<02:05,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  29%|██▉       | 18/62 [00:49<02:01,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  31%|███       | 19/62 [00:52<02:00,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  32%|███▏      | 20/62 [00:55<01:56,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  34%|███▍      | 21/62 [00:58<01:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  35%|███▌      | 22/62 [01:01<01:51,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  37%|███▋      | 23/62 [01:03<01:49,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  39%|███▊      | 24/62 [01:06<01:44,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  40%|████      | 25/62 [01:09<01:41,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  42%|████▏     | 26/62 [01:11<01:38,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  44%|████▎     | 27/62 [01:14<01:35,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  45%|████▌     | 28/62 [01:17<01:32,  2.72s/it]
Evaluating answer_prob of tofu on retain99:  47%|████▋     | 29/62 [01:20<01:30,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  48%|████▊     | 30/62 [01:22<01:27,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  50%|█████     | 31/62 [01:25<01:25,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  52%|█████▏    | 32/62 [01:28<01:23,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  53%|█████▎    | 33/62 [01:31<01:21,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  55%|█████▍    | 34/62 [01:34<01:18,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  56%|█████▋    | 35/62 [01:37<01:18,  2.89s/it]
Evaluating answer_prob of tofu on retain99:  58%|█████▊    | 36/62 [01:40<01:14,  2.86s/it]
Evaluating answer_prob of tofu on retain99:  60%|█████▉    | 37/62 [01:42<01:11,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  61%|██████▏   | 38/62 [01:45<01:08,  2.84s/it]
Evaluating answer_prob of tofu on retain99:  63%|██████▎   | 39/62 [01:48<01:05,  2.83s/it]
Evaluating answer_prob of tofu on retain99:  65%|██████▍   | 40/62 [01:51<01:02,  2.84s/it]
Evaluating answer_prob of tofu on retain99:  66%|██████▌   | 41/62 [01:54<00:58,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  68%|██████▊   | 42/62 [01:56<00:55,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  69%|██████▉   | 43/62 [01:59<00:52,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  71%|███████   | 44/62 [02:02<00:49,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  73%|███████▎  | 45/62 [02:05<00:47,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  74%|███████▍  | 46/62 [02:08<00:45,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  76%|███████▌  | 47/62 [02:11<00:42,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  77%|███████▋  | 48/62 [02:13<00:39,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  79%|███████▉  | 49/62 [02:16<00:36,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  81%|████████  | 50/62 [02:19<00:33,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  82%|████████▏ | 51/62 [02:21<00:30,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  84%|████████▍ | 52/62 [02:24<00:27,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  85%|████████▌ | 53/62 [02:27<00:24,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  87%|████████▋ | 54/62 [02:30<00:21,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  89%|████████▊ | 55/62 [02:33<00:19,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  90%|█████████ | 56/62 [02:35<00:16,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  92%|█████████▏| 57/62 [02:38<00:13,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  94%|█████████▎| 58/62 [02:41<00:11,  2.95s/it]
Evaluating answer_prob of tofu on retain99:  95%|█████████▌| 59/62 [02:44<00:08,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  97%|█████████▋| 60/62 [02:47<00:05,  2.89s/it]
Evaluating answer_prob of tofu on retain99:  98%|█████████▊| 61/62 [02:50<00:02,  2.84s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.73s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.79s/it]

Evaluating answer_prob of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
{'tofu_retain99_answer_prob': 0.9262945392824322}
{'tofu_forget01_answer_prob': 0.11420995458627278}

Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.29s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.65s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.05s/it]

Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.95s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.11s/it]
{'tofu-perturbed_real_authors_perturbed_normalized_answer_prob': 0.37712327147143265}
{'tofu-perturbed_world_facts_perturbed_normalized_answer_prob': 0.4088172666616249}

Evaluating truth_ratio of tofu-perturbed on retain_perturbed:   0%|          | 0/7 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  14%|█▍        | 1/7 [00:16<01:36, 16.12s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  29%|██▊       | 2/7 [00:32<01:20, 16.14s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  43%|████▎     | 3/7 [00:48<01:05, 16.32s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  57%|█████▋    | 4/7 [01:05<00:49, 16.44s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  71%|███████▏  | 5/7 [01:21<00:32, 16.43s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  86%|████████▌ | 6/7 [01:38<00:16, 16.64s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 12.57s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 14.73s/it]
{'tofu-perturbed_retain_perturbed_truth_ratio': 0.48282365025852303}

Evaluating truth_ratio of tofu-perturbed on forget01_perturbed:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.66s/it]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.66s/it]
{'tofu-perturbed_forget01_perturbed_truth_ratio': 0.6049233583235176}

Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.25s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.63s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.03s/it]

Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.93s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.95s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.10s/it]
{'tofu-perturbed_real_authors_perturbed_truth_ratio': 0.45618432759138655}
{'tofu-perturbed_world_facts_perturbed_truth_ratio': 0.49261710102443107}

Generating completions of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Generating completions of tofu on retain99:   2%|▏         | 1/62 [00:04<04:58,  4.90s/it]
Generating completions of tofu on retain99:   3%|▎         | 2/62 [00:09<04:30,  4.52s/it]
Generating completions of tofu on retain99:   5%|▍         | 3/62 [00:13<04:31,  4.61s/it]
Generating completions of tofu on retain99:   6%|▋         | 4/62 [00:18<04:35,  4.75s/it]
Generating completions of tofu on retain99:   8%|▊         | 5/62 [00:23<04:35,  4.84s/it]
Generating completions of tofu on retain99:  10%|▉         | 6/62 [00:28<04:36,  4.94s/it]
Generating completions of tofu on retain99:  11%|█▏        | 7/62 [00:33<04:27,  4.86s/it]
Generating completions of tofu on retain99:  13%|█▎        | 8/62 [00:38<04:21,  4.85s/it]
Generating completions of tofu on retain99:  15%|█▍        | 9/62 [00:44<04:38,  5.25s/it]
Generating completions of tofu on retain99:  16%|█▌        | 10/62 [00:49<04:33,  5.26s/it]
Generating completions of tofu on retain99:  18%|█▊        | 11/62 [00:54<04:16,  5.02s/it]
Generating completions of tofu on retain99:  19%|█▉        | 12/62 [00:59<04:05,  4.91s/it]
Generating completions of tofu on retain99:  21%|██        | 13/62 [01:03<03:59,  4.89s/it]
Generating completions of tofu on retain99:  23%|██▎       | 14/62 [01:09<04:01,  5.03s/it]
Generating completions of tofu on retain99:  24%|██▍       | 15/62 [01:14<03:58,  5.07s/it]
Generating completions of tofu on retain99:  26%|██▌       | 16/62 [01:19<03:54,  5.10s/it]
Generating completions of tofu on retain99:  27%|██▋       | 17/62 [01:24<03:49,  5.10s/it]
Generating completions of tofu on retain99:  29%|██▉       | 18/62 [01:29<03:39,  4.98s/it]
Generating completions of tofu on retain99:  31%|███       | 19/62 [01:34<03:30,  4.90s/it]
Generating completions of tofu on retain99:  32%|███▏      | 20/62 [01:40<03:38,  5.21s/it]
Generating completions of tofu on retain99:  34%|███▍      | 21/62 [01:44<03:24,  4.99s/it]
Generating completions of tofu on retain99:  35%|███▌      | 22/62 [01:49<03:20,  5.02s/it]
Generating completions of tofu on retain99:  37%|███▋      | 23/62 [01:54<03:18,  5.08s/it]
Generating completions of tofu on retain99:  39%|███▊      | 24/62 [01:59<03:06,  4.90s/it]
Generating completions of tofu on retain99:  40%|████      | 25/62 [02:04<03:01,  4.91s/it]
Generating completions of tofu on retain99:  42%|████▏     | 26/62 [02:09<03:00,  5.00s/it]
Generating completions of tofu on retain99:  44%|████▎     | 27/62 [02:14<02:53,  4.96s/it]
Generating completions of tofu on retain99:  45%|████▌     | 28/62 [02:18<02:45,  4.86s/it]
Generating completions of tofu on retain99:  47%|████▋     | 29/62 [02:24<02:43,  4.96s/it]
Generating completions of tofu on retain99:  48%|████▊     | 30/62 [02:29<02:40,  5.02s/it]
Generating completions of tofu on retain99:  50%|█████     | 31/62 [02:34<02:38,  5.12s/it]
Generating completions of tofu on retain99:  52%|█████▏    | 32/62 [02:40<02:37,  5.24s/it]
Generating completions of tofu on retain99:  53%|█████▎    | 33/62 [02:45<02:35,  5.37s/it]
Generating completions of tofu on retain99:  55%|█████▍    | 34/62 [02:51<02:32,  5.43s/it]
Generating completions of tofu on retain99:  56%|█████▋    | 35/62 [02:57<02:34,  5.73s/it]
Generating completions of tofu on retain99:  58%|█████▊    | 36/62 [03:03<02:26,  5.62s/it]
Generating completions of tofu on retain99:  60%|█████▉    | 37/62 [03:08<02:19,  5.58s/it]
Generating completions of tofu on retain99:  61%|██████▏   | 38/62 [03:13<02:09,  5.41s/it]
Generating completions of tofu on retain99:  63%|██████▎   | 39/62 [03:18<02:03,  5.35s/it]
Generating completions of tofu on retain99:  65%|██████▍   | 40/62 [03:24<01:57,  5.36s/it]
Generating completions of tofu on retain99:  66%|██████▌   | 41/62 [03:29<01:50,  5.26s/it]
Generating completions of tofu on retain99:  68%|██████▊   | 42/62 [03:34<01:43,  5.18s/it]
Generating completions of tofu on retain99:  69%|██████▉   | 43/62 [03:38<01:35,  5.04s/it]
Generating completions of tofu on retain99:  71%|███████   | 44/62 [03:45<01:36,  5.35s/it]
Generating completions of tofu on retain99:  73%|███████▎  | 45/62 [03:50<01:33,  5.49s/it]
Generating completions of tofu on retain99:  74%|███████▍  | 46/62 [03:56<01:27,  5.49s/it]
Generating completions of tofu on retain99:  76%|███████▌  | 47/62 [04:02<01:25,  5.69s/it]
Generating completions of tofu on retain99:  77%|███████▋  | 48/62 [04:07<01:15,  5.38s/it]
Generating completions of tofu on retain99:  79%|███████▉  | 49/62 [04:12<01:08,  5.23s/it]
Generating completions of tofu on retain99:  81%|████████  | 50/62 [04:17<01:02,  5.23s/it]
Generating completions of tofu on retain99:  82%|████████▏ | 51/62 [04:21<00:55,  5.02s/it]
Generating completions of tofu on retain99:  84%|████████▍ | 52/62 [04:27<00:51,  5.16s/it]
Generating completions of tofu on retain99:  85%|████████▌ | 53/62 [04:32<00:46,  5.20s/it]
Generating completions of tofu on retain99:  87%|████████▋ | 54/62 [04:37<00:39,  4.99s/it]
Generating completions of tofu on retain99:  89%|████████▊ | 55/62 [04:43<00:37,  5.32s/it]
Generating completions of tofu on retain99:  90%|█████████ | 56/62 [04:48<00:31,  5.26s/it]
Generating completions of tofu on retain99:  92%|█████████▏| 57/62 [04:52<00:25,  5.09s/it]
Generating completions of tofu on retain99:  94%|█████████▎| 58/62 [04:59<00:22,  5.63s/it]
Generating completions of tofu on retain99:  95%|█████████▌| 59/62 [05:05<00:16,  5.57s/it]
Generating completions of tofu on retain99:  97%|█████████▋| 60/62 [05:11<00:11,  5.78s/it]
Generating completions of tofu on retain99:  98%|█████████▊| 61/62 [05:16<00:05,  5.44s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.27s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.18s/it]
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 27]) torch.Size([64, 27])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 41]) torch.Size([64, 41])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 56]) torch.Size([64, 56])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 45]) torch.Size([64, 45])
torch.Size([64, 43]) torch.Size([64, 43])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 52]) torch.Size([64, 52])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([56, 42]) torch.Size([56, 42])

Generating completions of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.19s/it]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.19s/it]
torch.Size([40, 35]) torch.Size([40, 35])

Generating completions of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on real_authors:  50%|█████     | 1/2 [00:03<00:03,  3.45s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.65s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.77s/it]
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([36, 26]) torch.Size([36, 26])

Generating completions of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on world_facts:  50%|█████     | 1/2 [00:03<00:03,  3.94s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.70s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.74s/it]
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([53, 23]) torch.Size([53, 23])

Evaluating rougeL_recall of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on retain99:   5%|▍         | 3/62 [00:00<00:02, 24.85it/s]
Evaluating rougeL_recall of tofu on retain99:  10%|▉         | 6/62 [00:00<00:02, 22.46it/s]
Evaluating rougeL_recall of tofu on retain99:  15%|█▍        | 9/62 [00:00<00:02, 22.44it/s]
Evaluating rougeL_recall of tofu on retain99:  19%|█▉        | 12/62 [00:00<00:02, 23.31it/s]
Evaluating rougeL_recall of tofu on retain99:  24%|██▍       | 15/62 [00:00<00:01, 23.80it/s]
Evaluating rougeL_recall of tofu on retain99:  29%|██▉       | 18/62 [00:00<00:01, 23.51it/s]
Evaluating rougeL_recall of tofu on retain99:  34%|███▍      | 21/62 [00:00<00:01, 23.24it/s]
Evaluating rougeL_recall of tofu on retain99:  39%|███▊      | 24/62 [00:01<00:01, 23.35it/s]
Evaluating rougeL_recall of tofu on retain99:  44%|████▎     | 27/62 [00:01<00:01, 22.79it/s]
Evaluating rougeL_recall of tofu on retain99:  48%|████▊     | 30/62 [00:01<00:01, 23.42it/s]
Evaluating rougeL_recall of tofu on retain99:  53%|█████▎    | 33/62 [00:01<00:01, 23.11it/s]
Evaluating rougeL_recall of tofu on retain99:  58%|█████▊    | 36/62 [00:01<00:01, 22.12it/s]
Evaluating rougeL_recall of tofu on retain99:  63%|██████▎   | 39/62 [00:01<00:01, 21.23it/s]
Evaluating rougeL_recall of tofu on retain99:  68%|██████▊   | 42/62 [00:01<00:00, 21.20it/s]
Evaluating rougeL_recall of tofu on retain99:  73%|███████▎  | 45/62 [00:01<00:00, 21.69it/s]
Evaluating rougeL_recall of tofu on retain99:  77%|███████▋  | 48/62 [00:02<00:00, 21.75it/s]
Evaluating rougeL_recall of tofu on retain99:  82%|████████▏ | 51/62 [00:02<00:00, 21.87it/s]
Evaluating rougeL_recall of tofu on retain99:  87%|████████▋ | 54/62 [00:02<00:00, 21.50it/s]
Evaluating rougeL_recall of tofu on retain99:  92%|█████████▏| 57/62 [00:02<00:00, 21.67it/s]
Evaluating rougeL_recall of tofu on retain99:  97%|█████████▋| 60/62 [00:02<00:00, 21.36it/s]
Evaluating rougeL_recall of tofu on retain99: 100%|██████████| 62/62 [00:02<00:00, 22.21it/s]

Evaluating rougeL_recall of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on forget01: 100%|██████████| 1/1 [00:00<00:00, 34.40it/s]

Evaluating rougeL_recall of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on real_authors: 100%|██████████| 2/2 [00:00<00:00, 108.02it/s]

Evaluating rougeL_recall of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on world_facts: 100%|██████████| 2/2 [00:00<00:00, 87.00it/s]
{'tofu_retain99_rougeL_recall': 0.9198595009786571}
{'tofu_forget01_rougeL_recall': 0.33232919956139506}
{'tofu_real_authors_rougeL_recall': 0.5978333333333333}
{'tofu_world_facts_rougeL_recall': 0.8603988603988603}
name: corrupt
params:
  corrupt_args:
    dims: 1
    strength: 5
  corrupt_method: rand_noise_rand_n
  model_path: locuslab/tofu_ft_phi-1.5

Number of parameters: 1418270720

Evaluating answer_prob of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on retain99:   2%|▏         | 1/62 [00:02<02:43,  2.67s/it]
Evaluating answer_prob of tofu on retain99:   3%|▎         | 2/62 [00:05<02:39,  2.66s/it]
Evaluating answer_prob of tofu on retain99:   5%|▍         | 3/62 [00:08<02:38,  2.68s/it]
Evaluating answer_prob of tofu on retain99:   6%|▋         | 4/62 [00:10<02:36,  2.70s/it]
Evaluating answer_prob of tofu on retain99:   8%|▊         | 5/62 [00:13<02:34,  2.70s/it]
Evaluating answer_prob of tofu on retain99:  10%|▉         | 6/62 [00:16<02:35,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  11%|█▏        | 7/62 [00:19<02:32,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  13%|█▎        | 8/62 [00:21<02:29,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  15%|█▍        | 9/62 [00:24<02:28,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  16%|█▌        | 10/62 [00:27<02:24,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  18%|█▊        | 11/62 [00:30<02:19,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  19%|█▉        | 12/62 [00:32<02:16,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  21%|██        | 13/62 [00:35<02:13,  2.72s/it]
Evaluating answer_prob of tofu on retain99:  23%|██▎       | 14/62 [00:38<02:12,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  24%|██▍       | 15/62 [00:41<02:08,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  26%|██▌       | 16/62 [00:44<02:08,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  27%|██▋       | 17/62 [00:46<02:05,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  29%|██▉       | 18/62 [00:49<02:01,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  31%|███       | 19/62 [00:52<02:00,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  32%|███▏      | 20/62 [00:55<01:56,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  34%|███▍      | 21/62 [00:57<01:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  35%|███▌      | 22/62 [01:00<01:51,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  37%|███▋      | 23/62 [01:03<01:49,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  39%|███▊      | 24/62 [01:06<01:44,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  40%|████      | 25/62 [01:08<01:41,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  42%|████▏     | 26/62 [01:11<01:38,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  44%|████▎     | 27/62 [01:14<01:35,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  45%|████▌     | 28/62 [01:17<01:32,  2.72s/it]
Evaluating answer_prob of tofu on retain99:  47%|████▋     | 29/62 [01:19<01:30,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  48%|████▊     | 30/62 [01:22<01:27,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  50%|█████     | 31/62 [01:25<01:25,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  52%|█████▏    | 32/62 [01:28<01:23,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  53%|█████▎    | 33/62 [01:31<01:21,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  55%|█████▍    | 34/62 [01:33<01:18,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  56%|█████▋    | 35/62 [01:37<01:20,  2.96s/it]
Evaluating answer_prob of tofu on retain99:  58%|█████▊    | 36/62 [01:40<01:15,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  60%|█████▉    | 37/62 [01:42<01:12,  2.89s/it]
Evaluating answer_prob of tofu on retain99:  61%|██████▏   | 38/62 [01:45<01:08,  2.87s/it]
Evaluating answer_prob of tofu on retain99:  63%|██████▎   | 39/62 [01:48<01:05,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  65%|██████▍   | 40/62 [01:51<01:02,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  66%|██████▌   | 41/62 [01:54<00:59,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  68%|██████▊   | 42/62 [01:56<00:55,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  69%|██████▉   | 43/62 [01:59<00:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  71%|███████   | 44/62 [02:02<00:49,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  73%|███████▎  | 45/62 [02:05<00:47,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  74%|███████▍  | 46/62 [02:07<00:45,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  76%|███████▌  | 47/62 [02:10<00:42,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  77%|███████▋  | 48/62 [02:13<00:39,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  79%|███████▉  | 49/62 [02:16<00:36,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  81%|████████  | 50/62 [02:19<00:33,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  82%|████████▏ | 51/62 [02:21<00:30,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  84%|████████▍ | 52/62 [02:24<00:27,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  85%|████████▌ | 53/62 [02:27<00:24,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  87%|████████▋ | 54/62 [02:30<00:21,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  89%|████████▊ | 55/62 [02:32<00:19,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  90%|█████████ | 56/62 [02:35<00:16,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  92%|█████████▏| 57/62 [02:38<00:13,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  94%|█████████▎| 58/62 [02:41<00:11,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  95%|█████████▌| 59/62 [02:44<00:08,  2.88s/it]
Evaluating answer_prob of tofu on retain99:  97%|█████████▋| 60/62 [02:47<00:05,  2.87s/it]
Evaluating answer_prob of tofu on retain99:  98%|█████████▊| 61/62 [02:50<00:02,  2.83s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.72s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.78s/it]

Evaluating answer_prob of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
{'tofu_retain99_answer_prob': 0.9262945392824322}
{'tofu_forget01_answer_prob': 0.13486937067085666}

Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.27s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.65s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.04s/it]

Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.95s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.11s/it]
{'tofu-perturbed_real_authors_perturbed_normalized_answer_prob': 0.37712327147143265}
{'tofu-perturbed_world_facts_perturbed_normalized_answer_prob': 0.4088172666616249}

Evaluating truth_ratio of tofu-perturbed on retain_perturbed:   0%|          | 0/7 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  14%|█▍        | 1/7 [00:16<01:36, 16.14s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  29%|██▊       | 2/7 [00:32<01:20, 16.16s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  43%|████▎     | 3/7 [00:48<01:05, 16.34s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  57%|█████▋    | 4/7 [01:05<00:49, 16.47s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  71%|███████▏  | 5/7 [01:21<00:32, 16.45s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  86%|████████▌ | 6/7 [01:39<00:16, 16.66s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 12.59s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 14.74s/it]
{'tofu-perturbed_retain_perturbed_truth_ratio': 0.48282365025852303}

Evaluating truth_ratio of tofu-perturbed on forget01_perturbed:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.68s/it]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.68s/it]
{'tofu-perturbed_forget01_perturbed_truth_ratio': 0.5748578250572051}

Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.27s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.65s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.04s/it]

Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.95s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.11s/it]
{'tofu-perturbed_real_authors_perturbed_truth_ratio': 0.45618432759138655}
{'tofu-perturbed_world_facts_perturbed_truth_ratio': 0.49261710102443107}

Generating completions of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Generating completions of tofu on retain99:   2%|▏         | 1/62 [00:04<04:57,  4.88s/it]
Generating completions of tofu on retain99:   3%|▎         | 2/62 [00:09<04:30,  4.51s/it]
Generating completions of tofu on retain99:   5%|▍         | 3/62 [00:14<04:36,  4.69s/it]
Generating completions of tofu on retain99:   6%|▋         | 4/62 [00:19<04:38,  4.80s/it]
Generating completions of tofu on retain99:   8%|▊         | 5/62 [00:24<04:37,  4.87s/it]
Generating completions of tofu on retain99:  10%|▉         | 6/62 [00:29<04:38,  4.97s/it]
Generating completions of tofu on retain99:  11%|█▏        | 7/62 [00:33<04:28,  4.88s/it]
Generating completions of tofu on retain99:  13%|█▎        | 8/62 [00:38<04:22,  4.86s/it]
Generating completions of tofu on retain99:  15%|█▍        | 9/62 [00:44<04:38,  5.26s/it]
Generating completions of tofu on retain99:  16%|█▌        | 10/62 [00:50<04:33,  5.27s/it]
Generating completions of tofu on retain99:  18%|█▊        | 11/62 [00:54<04:16,  5.03s/it]
Generating completions of tofu on retain99:  19%|█▉        | 12/62 [00:59<04:05,  4.91s/it]
Generating completions of tofu on retain99:  21%|██        | 13/62 [01:04<04:00,  4.90s/it]
Generating completions of tofu on retain99:  23%|██▎       | 14/62 [01:09<04:02,  5.04s/it]
Generating completions of tofu on retain99:  24%|██▍       | 15/62 [01:14<03:58,  5.08s/it]
Generating completions of tofu on retain99:  26%|██▌       | 16/62 [01:19<03:54,  5.11s/it]
Generating completions of tofu on retain99:  27%|██▋       | 17/62 [01:24<03:49,  5.11s/it]
Generating completions of tofu on retain99:  29%|██▉       | 18/62 [01:29<03:39,  4.98s/it]
Generating completions of tofu on retain99:  31%|███       | 19/62 [01:34<03:31,  4.91s/it]
Generating completions of tofu on retain99:  32%|███▏      | 20/62 [01:40<03:38,  5.21s/it]
Generating completions of tofu on retain99:  34%|███▍      | 21/62 [01:44<03:24,  4.99s/it]
Generating completions of tofu on retain99:  35%|███▌      | 22/62 [01:49<03:20,  5.02s/it]
Generating completions of tofu on retain99:  37%|███▋      | 23/62 [01:55<03:18,  5.08s/it]
Generating completions of tofu on retain99:  39%|███▊      | 24/62 [01:59<03:06,  4.90s/it]
Generating completions of tofu on retain99:  40%|████      | 25/62 [02:04<03:01,  4.91s/it]
Generating completions of tofu on retain99:  42%|████▏     | 26/62 [02:09<03:00,  5.01s/it]
Generating completions of tofu on retain99:  44%|████▎     | 27/62 [02:14<02:53,  4.97s/it]
Generating completions of tofu on retain99:  45%|████▌     | 28/62 [02:19<02:45,  4.86s/it]
Generating completions of tofu on retain99:  47%|████▋     | 29/62 [02:24<02:43,  4.97s/it]
Generating completions of tofu on retain99:  48%|████▊     | 30/62 [02:29<02:40,  5.02s/it]
Generating completions of tofu on retain99:  50%|█████     | 31/62 [02:34<02:38,  5.12s/it]
Generating completions of tofu on retain99:  52%|█████▏    | 32/62 [02:40<02:37,  5.24s/it]
Generating completions of tofu on retain99:  53%|█████▎    | 33/62 [02:46<02:35,  5.38s/it]
Generating completions of tofu on retain99:  55%|█████▍    | 34/62 [02:51<02:32,  5.43s/it]
Generating completions of tofu on retain99:  56%|█████▋    | 35/62 [02:58<02:34,  5.73s/it]
Generating completions of tofu on retain99:  58%|█████▊    | 36/62 [03:03<02:26,  5.62s/it]
Generating completions of tofu on retain99:  60%|█████▉    | 37/62 [03:08<02:19,  5.59s/it]
Generating completions of tofu on retain99:  61%|██████▏   | 38/62 [03:14<02:09,  5.41s/it]
Generating completions of tofu on retain99:  63%|██████▎   | 39/62 [03:19<02:03,  5.35s/it]
Generating completions of tofu on retain99:  65%|██████▍   | 40/62 [03:24<01:57,  5.36s/it]
Generating completions of tofu on retain99:  66%|██████▌   | 41/62 [03:29<01:50,  5.26s/it]
Generating completions of tofu on retain99:  68%|██████▊   | 42/62 [03:34<01:43,  5.18s/it]
Generating completions of tofu on retain99:  69%|██████▉   | 43/62 [03:39<01:35,  5.04s/it]
Generating completions of tofu on retain99:  71%|███████   | 44/62 [03:45<01:36,  5.36s/it]
Generating completions of tofu on retain99:  73%|███████▎  | 45/62 [03:51<01:33,  5.49s/it]
Generating completions of tofu on retain99:  74%|███████▍  | 46/62 [03:56<01:27,  5.49s/it]
Generating completions of tofu on retain99:  76%|███████▌  | 47/62 [04:02<01:25,  5.69s/it]
Generating completions of tofu on retain99:  77%|███████▋  | 48/62 [04:07<01:15,  5.39s/it]
Generating completions of tofu on retain99:  79%|███████▉  | 49/62 [04:12<01:08,  5.24s/it]
Generating completions of tofu on retain99:  81%|████████  | 50/62 [04:17<01:02,  5.24s/it]
Generating completions of tofu on retain99:  82%|████████▏ | 51/62 [04:22<00:55,  5.02s/it]
Generating completions of tofu on retain99:  84%|████████▍ | 52/62 [04:27<00:51,  5.17s/it]
Generating completions of tofu on retain99:  85%|████████▌ | 53/62 [04:32<00:46,  5.20s/it]
Generating completions of tofu on retain99:  87%|████████▋ | 54/62 [04:37<00:39,  4.99s/it]
Generating completions of tofu on retain99:  89%|████████▊ | 55/62 [04:43<00:37,  5.32s/it]
Generating completions of tofu on retain99:  90%|█████████ | 56/62 [04:48<00:31,  5.26s/it]
Generating completions of tofu on retain99:  92%|█████████▏| 57/62 [04:53<00:25,  5.09s/it]
Generating completions of tofu on retain99:  94%|█████████▎| 58/62 [05:00<00:22,  5.63s/it]
Generating completions of tofu on retain99:  95%|█████████▌| 59/62 [05:05<00:16,  5.58s/it]
Generating completions of tofu on retain99:  97%|█████████▋| 60/62 [05:12<00:11,  5.78s/it]
Generating completions of tofu on retain99:  98%|█████████▊| 61/62 [05:16<00:05,  5.44s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.28s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.19s/it]
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 27]) torch.Size([64, 27])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 41]) torch.Size([64, 41])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 56]) torch.Size([64, 56])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 45]) torch.Size([64, 45])
torch.Size([64, 43]) torch.Size([64, 43])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 52]) torch.Size([64, 52])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([56, 42]) torch.Size([56, 42])

Generating completions of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:04<00:00,  4.58s/it]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:04<00:00,  4.58s/it]
torch.Size([40, 35]) torch.Size([40, 35])

Generating completions of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on real_authors:  50%|█████     | 1/2 [00:03<00:03,  3.45s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.66s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.78s/it]
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([36, 26]) torch.Size([36, 26])

Generating completions of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on world_facts:  50%|█████     | 1/2 [00:03<00:03,  3.95s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.70s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.74s/it]
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([53, 23]) torch.Size([53, 23])

Evaluating rougeL_recall of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on retain99:   5%|▍         | 3/62 [00:00<00:02, 24.61it/s]
Evaluating rougeL_recall of tofu on retain99:  10%|▉         | 6/62 [00:00<00:02, 22.50it/s]
Evaluating rougeL_recall of tofu on retain99:  15%|█▍        | 9/62 [00:00<00:02, 22.32it/s]
Evaluating rougeL_recall of tofu on retain99:  19%|█▉        | 12/62 [00:00<00:02, 23.00it/s]
Evaluating rougeL_recall of tofu on retain99:  24%|██▍       | 15/62 [00:00<00:01, 23.51it/s]
Evaluating rougeL_recall of tofu on retain99:  29%|██▉       | 18/62 [00:00<00:01, 23.26it/s]
Evaluating rougeL_recall of tofu on retain99:  34%|███▍      | 21/62 [00:00<00:01, 23.01it/s]
Evaluating rougeL_recall of tofu on retain99:  39%|███▊      | 24/62 [00:01<00:01, 23.15it/s]
Evaluating rougeL_recall of tofu on retain99:  44%|████▎     | 27/62 [00:01<00:01, 22.61it/s]
Evaluating rougeL_recall of tofu on retain99:  48%|████▊     | 30/62 [00:01<00:01, 23.25it/s]
Evaluating rougeL_recall of tofu on retain99:  53%|█████▎    | 33/62 [00:01<00:01, 22.95it/s]
Evaluating rougeL_recall of tofu on retain99:  58%|█████▊    | 36/62 [00:01<00:01, 22.00it/s]
Evaluating rougeL_recall of tofu on retain99:  63%|██████▎   | 39/62 [00:01<00:01, 21.16it/s]
Evaluating rougeL_recall of tofu on retain99:  68%|██████▊   | 42/62 [00:01<00:00, 21.16it/s]
Evaluating rougeL_recall of tofu on retain99:  73%|███████▎  | 45/62 [00:02<00:00, 21.66it/s]
Evaluating rougeL_recall of tofu on retain99:  77%|███████▋  | 48/62 [00:02<00:00, 21.70it/s]
Evaluating rougeL_recall of tofu on retain99:  82%|████████▏ | 51/62 [00:02<00:00, 21.79it/s]
Evaluating rougeL_recall of tofu on retain99:  87%|████████▋ | 54/62 [00:02<00:00, 21.42it/s]
Evaluating rougeL_recall of tofu on retain99:  92%|█████████▏| 57/62 [00:02<00:00, 21.61it/s]
Evaluating rougeL_recall of tofu on retain99:  97%|█████████▋| 60/62 [00:02<00:00, 21.31it/s]
Evaluating rougeL_recall of tofu on retain99: 100%|██████████| 62/62 [00:02<00:00, 22.10it/s]

Evaluating rougeL_recall of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on forget01: 100%|██████████| 1/1 [00:00<00:00, 32.79it/s]

Evaluating rougeL_recall of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on real_authors: 100%|██████████| 2/2 [00:00<00:00, 108.02it/s]

Evaluating rougeL_recall of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on world_facts: 100%|██████████| 2/2 [00:00<00:00, 86.84it/s]
{'tofu_retain99_rougeL_recall': 0.9198595009786571}
{'tofu_forget01_rougeL_recall': 0.31947763936726414}
{'tofu_real_authors_rougeL_recall': 0.5978333333333333}
{'tofu_world_facts_rougeL_recall': 0.8603988603988603}
name: corrupt
params:
  corrupt_args:
    dims: 507
    strength: null
  corrupt_method: zero_out_top_k
  model_path: locuslab/tofu_ft_phi-1.5

Number of parameters: 1418270720

Evaluating answer_prob of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on retain99:   2%|▏         | 1/62 [00:02<02:44,  2.69s/it]
Evaluating answer_prob of tofu on retain99:   3%|▎         | 2/62 [00:05<02:40,  2.67s/it]
Evaluating answer_prob of tofu on retain99:   5%|▍         | 3/62 [00:08<02:38,  2.69s/it]
Evaluating answer_prob of tofu on retain99:   6%|▋         | 4/62 [00:10<02:37,  2.71s/it]
Evaluating answer_prob of tofu on retain99:   8%|▊         | 5/62 [00:13<02:34,  2.71s/it]
Evaluating answer_prob of tofu on retain99:  10%|▉         | 6/62 [00:16<02:36,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  11%|█▏        | 7/62 [00:19<02:32,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  13%|█▎        | 8/62 [00:21<02:29,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  15%|█▍        | 9/62 [00:24<02:28,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  16%|█▌        | 10/62 [00:27<02:24,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  18%|█▊        | 11/62 [00:30<02:19,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  19%|█▉        | 12/62 [00:32<02:16,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  21%|██        | 13/62 [00:35<02:12,  2.71s/it]
Evaluating answer_prob of tofu on retain99:  23%|██▎       | 14/62 [00:38<02:12,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  24%|██▍       | 15/62 [00:41<02:08,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  26%|██▌       | 16/62 [00:44<02:08,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  27%|██▋       | 17/62 [00:46<02:05,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  29%|██▉       | 18/62 [00:49<02:01,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  31%|███       | 19/62 [00:52<02:00,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  32%|███▏      | 20/62 [00:55<01:56,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  34%|███▍      | 21/62 [00:57<01:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  35%|███▌      | 22/62 [01:00<01:51,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  37%|███▋      | 23/62 [01:03<01:48,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  39%|███▊      | 24/62 [01:06<01:44,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  40%|████      | 25/62 [01:08<01:41,  2.73s/it]
Evaluating answer_prob of tofu on retain99:  42%|████▏     | 26/62 [01:11<01:38,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  44%|████▎     | 27/62 [01:14<01:35,  2.73s/it]
Evaluating answer_prob of tofu on retain99:  45%|████▌     | 28/62 [01:17<01:32,  2.72s/it]
Evaluating answer_prob of tofu on retain99:  47%|████▋     | 29/62 [01:19<01:30,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  48%|████▊     | 30/62 [01:22<01:27,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  50%|█████     | 31/62 [01:25<01:24,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  52%|█████▏    | 32/62 [01:28<01:23,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  53%|█████▎    | 33/62 [01:31<01:21,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  55%|█████▍    | 34/62 [01:33<01:18,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  56%|█████▋    | 35/62 [01:37<01:19,  2.96s/it]
Evaluating answer_prob of tofu on retain99:  58%|█████▊    | 36/62 [01:39<01:15,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  60%|█████▉    | 37/62 [01:42<01:12,  2.88s/it]
Evaluating answer_prob of tofu on retain99:  61%|██████▏   | 38/62 [01:45<01:08,  2.86s/it]
Evaluating answer_prob of tofu on retain99:  63%|██████▎   | 39/62 [01:48<01:05,  2.84s/it]
Evaluating answer_prob of tofu on retain99:  65%|██████▍   | 40/62 [01:51<01:02,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  66%|██████▌   | 41/62 [01:53<00:59,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  68%|██████▊   | 42/62 [01:56<00:55,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  69%|██████▉   | 43/62 [01:59<00:52,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  71%|███████   | 44/62 [02:02<00:49,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  73%|███████▎  | 45/62 [02:05<00:47,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  74%|███████▍  | 46/62 [02:07<00:45,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  76%|███████▌  | 47/62 [02:10<00:42,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  77%|███████▋  | 48/62 [02:13<00:39,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  79%|███████▉  | 49/62 [02:16<00:36,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  81%|████████  | 50/62 [02:18<00:33,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  82%|████████▏ | 51/62 [02:21<00:30,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  84%|████████▍ | 52/62 [02:24<00:27,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  85%|████████▌ | 53/62 [02:27<00:24,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  87%|████████▋ | 54/62 [02:29<00:21,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  89%|████████▊ | 55/62 [02:32<00:19,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  90%|█████████ | 56/62 [02:35<00:16,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  92%|█████████▏| 57/62 [02:38<00:13,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  94%|█████████▎| 58/62 [02:41<00:11,  2.90s/it]
Evaluating answer_prob of tofu on retain99:  95%|█████████▌| 59/62 [02:44<00:08,  2.88s/it]
Evaluating answer_prob of tofu on retain99:  97%|█████████▋| 60/62 [02:47<00:05,  2.87s/it]
Evaluating answer_prob of tofu on retain99:  98%|█████████▊| 61/62 [02:49<00:02,  2.82s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.72s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.78s/it]

Evaluating answer_prob of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.82s/it]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.82s/it]
{'tofu_retain99_answer_prob': 0.9262945392824322}
{'tofu_forget01_answer_prob': 0.34712329390035024}

Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.26s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.64s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.03s/it]

Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.94s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.11s/it]
{'tofu-perturbed_real_authors_perturbed_normalized_answer_prob': 0.37712327147143265}
{'tofu-perturbed_world_facts_perturbed_normalized_answer_prob': 0.4088172666616249}

Evaluating truth_ratio of tofu-perturbed on retain_perturbed:   0%|          | 0/7 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  14%|█▍        | 1/7 [00:16<01:36, 16.13s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  29%|██▊       | 2/7 [00:32<01:20, 16.15s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  43%|████▎     | 3/7 [00:48<01:05, 16.33s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  57%|█████▋    | 4/7 [01:05<00:49, 16.45s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  71%|███████▏  | 5/7 [01:21<00:32, 16.44s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  86%|████████▌ | 6/7 [01:38<00:16, 16.64s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 12.57s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 14.73s/it]
{'tofu-perturbed_retain_perturbed_truth_ratio': 0.48282365025852303}

Evaluating truth_ratio of tofu-perturbed on forget01_perturbed:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.68s/it]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.68s/it]
{'tofu-perturbed_forget01_perturbed_truth_ratio': 0.6427538968901775}

Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.26s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.64s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.03s/it]

Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.94s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.95s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.10s/it]
{'tofu-perturbed_real_authors_perturbed_truth_ratio': 0.45618432759138655}
{'tofu-perturbed_world_facts_perturbed_truth_ratio': 0.49261710102443107}

Generating completions of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Generating completions of tofu on retain99:   2%|▏         | 1/62 [00:04<04:56,  4.87s/it]
Generating completions of tofu on retain99:   3%|▎         | 2/62 [00:09<04:30,  4.50s/it]
Generating completions of tofu on retain99:   5%|▍         | 3/62 [00:13<04:31,  4.60s/it]
Generating completions of tofu on retain99:   6%|▋         | 4/62 [00:18<04:35,  4.75s/it]
Generating completions of tofu on retain99:   8%|▊         | 5/62 [00:23<04:35,  4.83s/it]
Generating completions of tofu on retain99:  10%|▉         | 6/62 [00:28<04:36,  4.94s/it]
Generating completions of tofu on retain99:  11%|█▏        | 7/62 [00:33<04:27,  4.86s/it]
Generating completions of tofu on retain99:  13%|█▎        | 8/62 [00:38<04:21,  4.85s/it]
Generating completions of tofu on retain99:  15%|█▍        | 9/62 [00:44<04:38,  5.25s/it]
Generating completions of tofu on retain99:  16%|█▌        | 10/62 [00:49<04:33,  5.26s/it]
Generating completions of tofu on retain99:  18%|█▊        | 11/62 [00:54<04:16,  5.02s/it]
Generating completions of tofu on retain99:  19%|█▉        | 12/62 [00:58<04:05,  4.91s/it]
Generating completions of tofu on retain99:  21%|██        | 13/62 [01:03<03:59,  4.89s/it]
Generating completions of tofu on retain99:  23%|██▎       | 14/62 [01:09<04:01,  5.04s/it]
Generating completions of tofu on retain99:  24%|██▍       | 15/62 [01:14<04:00,  5.12s/it]
Generating completions of tofu on retain99:  26%|██▌       | 16/62 [01:19<03:56,  5.14s/it]
Generating completions of tofu on retain99:  27%|██▋       | 17/62 [01:24<03:50,  5.12s/it]
Generating completions of tofu on retain99:  29%|██▉       | 18/62 [01:29<03:39,  4.99s/it]
Generating completions of tofu on retain99:  31%|███       | 19/62 [01:34<03:31,  4.91s/it]
Generating completions of tofu on retain99:  32%|███▏      | 20/62 [01:40<03:38,  5.21s/it]
Generating completions of tofu on retain99:  34%|███▍      | 21/62 [01:44<03:24,  4.99s/it]
Generating completions of tofu on retain99:  35%|███▌      | 22/62 [01:49<03:20,  5.02s/it]
Generating completions of tofu on retain99:  37%|███▋      | 23/62 [01:54<03:18,  5.08s/it]
Generating completions of tofu on retain99:  39%|███▊      | 24/62 [01:59<03:06,  4.90s/it]
Generating completions of tofu on retain99:  40%|████      | 25/62 [02:04<03:01,  4.91s/it]
Generating completions of tofu on retain99:  42%|████▏     | 26/62 [02:09<03:00,  5.00s/it]
Generating completions of tofu on retain99:  44%|████▎     | 27/62 [02:14<02:53,  4.97s/it]
Generating completions of tofu on retain99:  45%|████▌     | 28/62 [02:19<02:45,  4.86s/it]
Generating completions of tofu on retain99:  47%|████▋     | 29/62 [02:24<02:43,  4.97s/it]
Generating completions of tofu on retain99:  48%|████▊     | 30/62 [02:29<02:40,  5.02s/it]
Generating completions of tofu on retain99:  50%|█████     | 31/62 [02:34<02:38,  5.12s/it]
Generating completions of tofu on retain99:  52%|█████▏    | 32/62 [02:40<02:37,  5.24s/it]
Generating completions of tofu on retain99:  53%|█████▎    | 33/62 [02:45<02:35,  5.38s/it]
Generating completions of tofu on retain99:  55%|█████▍    | 34/62 [02:51<02:32,  5.43s/it]
Generating completions of tofu on retain99:  56%|█████▋    | 35/62 [02:57<02:34,  5.73s/it]
Generating completions of tofu on retain99:  58%|█████▊    | 36/62 [03:03<02:26,  5.62s/it]
Generating completions of tofu on retain99:  60%|█████▉    | 37/62 [03:08<02:19,  5.59s/it]
Generating completions of tofu on retain99:  61%|██████▏   | 38/62 [03:13<02:09,  5.41s/it]
Generating completions of tofu on retain99:  63%|██████▎   | 39/62 [03:19<02:03,  5.35s/it]
Generating completions of tofu on retain99:  65%|██████▍   | 40/62 [03:24<01:57,  5.36s/it]
Generating completions of tofu on retain99:  66%|██████▌   | 41/62 [03:29<01:50,  5.26s/it]
Generating completions of tofu on retain99:  68%|██████▊   | 42/62 [03:34<01:43,  5.18s/it]
Generating completions of tofu on retain99:  69%|██████▉   | 43/62 [03:39<01:35,  5.04s/it]
Generating completions of tofu on retain99:  71%|███████   | 44/62 [03:45<01:36,  5.36s/it]
Generating completions of tofu on retain99:  73%|███████▎  | 45/62 [03:51<01:33,  5.49s/it]
Generating completions of tofu on retain99:  74%|███████▍  | 46/62 [03:56<01:27,  5.49s/it]
Generating completions of tofu on retain99:  76%|███████▌  | 47/62 [04:02<01:25,  5.69s/it]
Generating completions of tofu on retain99:  77%|███████▋  | 48/62 [04:07<01:15,  5.39s/it]
Generating completions of tofu on retain99:  79%|███████▉  | 49/62 [04:12<01:08,  5.24s/it]
Generating completions of tofu on retain99:  81%|████████  | 50/62 [04:17<01:02,  5.24s/it]
Generating completions of tofu on retain99:  82%|████████▏ | 51/62 [04:22<00:55,  5.02s/it]
Generating completions of tofu on retain99:  84%|████████▍ | 52/62 [04:27<00:51,  5.16s/it]
Generating completions of tofu on retain99:  85%|████████▌ | 53/62 [04:32<00:46,  5.20s/it]
Generating completions of tofu on retain99:  87%|████████▋ | 54/62 [04:37<00:39,  4.99s/it]
Generating completions of tofu on retain99:  89%|████████▊ | 55/62 [04:43<00:37,  5.32s/it]
Generating completions of tofu on retain99:  90%|█████████ | 56/62 [04:48<00:31,  5.26s/it]
Generating completions of tofu on retain99:  92%|█████████▏| 57/62 [04:53<00:25,  5.09s/it]
Generating completions of tofu on retain99:  94%|█████████▎| 58/62 [05:00<00:22,  5.63s/it]
Generating completions of tofu on retain99:  95%|█████████▌| 59/62 [05:05<00:16,  5.58s/it]
Generating completions of tofu on retain99:  97%|█████████▋| 60/62 [05:11<00:11,  5.78s/it]
Generating completions of tofu on retain99:  98%|█████████▊| 61/62 [05:16<00:05,  5.44s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.27s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.18s/it]
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 27]) torch.Size([64, 27])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 41]) torch.Size([64, 41])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 56]) torch.Size([64, 56])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 45]) torch.Size([64, 45])
torch.Size([64, 43]) torch.Size([64, 43])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 52]) torch.Size([64, 52])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([56, 42]) torch.Size([56, 42])

Generating completions of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.20s/it]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.20s/it]
torch.Size([40, 35]) torch.Size([40, 35])

Generating completions of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on real_authors:  50%|█████     | 1/2 [00:03<00:03,  3.45s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.65s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.77s/it]
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([36, 26]) torch.Size([36, 26])

Generating completions of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on world_facts:  50%|█████     | 1/2 [00:03<00:03,  3.95s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.70s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.74s/it]
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([53, 23]) torch.Size([53, 23])

Evaluating rougeL_recall of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on retain99:   5%|▍         | 3/62 [00:00<00:02, 24.93it/s]
Evaluating rougeL_recall of tofu on retain99:  10%|▉         | 6/62 [00:00<00:02, 22.24it/s]
Evaluating rougeL_recall of tofu on retain99:  15%|█▍        | 9/62 [00:00<00:02, 22.15it/s]
Evaluating rougeL_recall of tofu on retain99:  19%|█▉        | 12/62 [00:00<00:02, 22.98it/s]
Evaluating rougeL_recall of tofu on retain99:  24%|██▍       | 15/62 [00:00<00:01, 23.58it/s]
Evaluating rougeL_recall of tofu on retain99:  29%|██▉       | 18/62 [00:00<00:01, 23.31it/s]
Evaluating rougeL_recall of tofu on retain99:  34%|███▍      | 21/62 [00:00<00:01, 23.03it/s]
Evaluating rougeL_recall of tofu on retain99:  39%|███▊      | 24/62 [00:01<00:01, 23.25it/s]
Evaluating rougeL_recall of tofu on retain99:  44%|████▎     | 27/62 [00:01<00:01, 22.70it/s]
Evaluating rougeL_recall of tofu on retain99:  48%|████▊     | 30/62 [00:01<00:01, 23.31it/s]
Evaluating rougeL_recall of tofu on retain99:  53%|█████▎    | 33/62 [00:01<00:01, 22.99it/s]
Evaluating rougeL_recall of tofu on retain99:  58%|█████▊    | 36/62 [00:01<00:01, 22.05it/s]
Evaluating rougeL_recall of tofu on retain99:  63%|██████▎   | 39/62 [00:01<00:01, 21.20it/s]
Evaluating rougeL_recall of tofu on retain99:  68%|██████▊   | 42/62 [00:01<00:00, 21.27it/s]
Evaluating rougeL_recall of tofu on retain99:  73%|███████▎  | 45/62 [00:02<00:00, 21.75it/s]
Evaluating rougeL_recall of tofu on retain99:  77%|███████▋  | 48/62 [00:02<00:00, 21.79it/s]
Evaluating rougeL_recall of tofu on retain99:  82%|████████▏ | 51/62 [00:02<00:00, 21.94it/s]
Evaluating rougeL_recall of tofu on retain99:  87%|████████▋ | 54/62 [00:02<00:00, 21.53it/s]
Evaluating rougeL_recall of tofu on retain99:  92%|█████████▏| 57/62 [00:02<00:00, 21.67it/s]
Evaluating rougeL_recall of tofu on retain99:  97%|█████████▋| 60/62 [00:02<00:00, 21.32it/s]
Evaluating rougeL_recall of tofu on retain99: 100%|██████████| 62/62 [00:02<00:00, 22.14it/s]

Evaluating rougeL_recall of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on forget01: 100%|██████████| 1/1 [00:00<00:00, 33.97it/s]

Evaluating rougeL_recall of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on real_authors: 100%|██████████| 2/2 [00:00<00:00, 107.42it/s]

Evaluating rougeL_recall of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on world_facts: 100%|██████████| 2/2 [00:00<00:00, 86.31it/s]
{'tofu_retain99_rougeL_recall': 0.9198595009786571}
{'tofu_forget01_rougeL_recall': 0.4307648769765895}
{'tofu_real_authors_rougeL_recall': 0.5978333333333333}
{'tofu_world_facts_rougeL_recall': 0.8603988603988603}
name: corrupt
params:
  corrupt_args:
    dims: 2048
    strength: null
  corrupt_method: flip_sign_top_k
  model_path: locuslab/tofu_ft_phi-1.5

Number of parameters: 1418270720

Evaluating answer_prob of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on retain99:   2%|▏         | 1/62 [00:02<02:43,  2.67s/it]
Evaluating answer_prob of tofu on retain99:   3%|▎         | 2/62 [00:05<02:39,  2.66s/it]
Evaluating answer_prob of tofu on retain99:   5%|▍         | 3/62 [00:08<02:38,  2.68s/it]
Evaluating answer_prob of tofu on retain99:   6%|▋         | 4/62 [00:10<02:36,  2.70s/it]
Evaluating answer_prob of tofu on retain99:   8%|▊         | 5/62 [00:13<02:33,  2.70s/it]
Evaluating answer_prob of tofu on retain99:  10%|▉         | 6/62 [00:16<02:35,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  11%|█▏        | 7/62 [00:19<02:32,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  13%|█▎        | 8/62 [00:21<02:29,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  15%|█▍        | 9/62 [00:24<02:28,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  16%|█▌        | 10/62 [00:27<02:24,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  18%|█▊        | 11/62 [00:30<02:19,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  19%|█▉        | 12/62 [00:32<02:16,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  21%|██        | 13/62 [00:35<02:13,  2.71s/it]
Evaluating answer_prob of tofu on retain99:  23%|██▎       | 14/62 [00:38<02:12,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  24%|██▍       | 15/62 [00:41<02:08,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  26%|██▌       | 16/62 [00:44<02:08,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  27%|██▋       | 17/62 [00:46<02:05,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  29%|██▉       | 18/62 [00:49<02:01,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  31%|███       | 19/62 [00:52<02:00,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  32%|███▏      | 20/62 [00:55<01:56,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  34%|███▍      | 21/62 [00:57<01:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  35%|███▌      | 22/62 [01:00<01:51,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  37%|███▋      | 23/62 [01:03<01:49,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  39%|███▊      | 24/62 [01:06<01:44,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  40%|████      | 25/62 [01:08<01:41,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  42%|████▏     | 26/62 [01:11<01:38,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  44%|████▎     | 27/62 [01:14<01:35,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  45%|████▌     | 28/62 [01:17<01:32,  2.72s/it]
Evaluating answer_prob of tofu on retain99:  47%|████▋     | 29/62 [01:19<01:30,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  48%|████▊     | 30/62 [01:22<01:27,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  50%|█████     | 31/62 [01:25<01:25,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  52%|█████▏    | 32/62 [01:28<01:23,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  53%|█████▎    | 33/62 [01:31<01:21,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  55%|█████▍    | 34/62 [01:33<01:18,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  56%|█████▋    | 35/62 [01:37<01:20,  2.97s/it]
Evaluating answer_prob of tofu on retain99:  58%|█████▊    | 36/62 [01:39<01:15,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  60%|█████▉    | 37/62 [01:42<01:12,  2.89s/it]
Evaluating answer_prob of tofu on retain99:  61%|██████▏   | 38/62 [01:45<01:08,  2.87s/it]
Evaluating answer_prob of tofu on retain99:  63%|██████▎   | 39/62 [01:48<01:05,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  65%|██████▍   | 40/62 [01:51<01:02,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  66%|██████▌   | 41/62 [01:54<00:59,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  68%|██████▊   | 42/62 [01:56<00:55,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  69%|██████▉   | 43/62 [01:59<00:52,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  71%|███████   | 44/62 [02:02<00:49,  2.77s/it]
Evaluating answer_prob of tofu on retain99:  73%|███████▎  | 45/62 [02:05<00:47,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  74%|███████▍  | 46/62 [02:07<00:45,  2.82s/it]
Evaluating answer_prob of tofu on retain99:  76%|███████▌  | 47/62 [02:10<00:42,  2.85s/it]
Evaluating answer_prob of tofu on retain99:  77%|███████▋  | 48/62 [02:13<00:39,  2.81s/it]
Evaluating answer_prob of tofu on retain99:  79%|███████▉  | 49/62 [02:16<00:36,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  81%|████████  | 50/62 [02:19<00:33,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  82%|████████▏ | 51/62 [02:21<00:30,  2.75s/it]
Evaluating answer_prob of tofu on retain99:  84%|████████▍ | 52/62 [02:24<00:27,  2.78s/it]
Evaluating answer_prob of tofu on retain99:  85%|████████▌ | 53/62 [02:27<00:24,  2.76s/it]
Evaluating answer_prob of tofu on retain99:  87%|████████▋ | 54/62 [02:29<00:21,  2.74s/it]
Evaluating answer_prob of tofu on retain99:  89%|████████▊ | 55/62 [02:32<00:19,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  90%|█████████ | 56/62 [02:35<00:16,  2.79s/it]
Evaluating answer_prob of tofu on retain99:  92%|█████████▏| 57/62 [02:38<00:13,  2.80s/it]
Evaluating answer_prob of tofu on retain99:  94%|█████████▎| 58/62 [02:41<00:11,  2.91s/it]
Evaluating answer_prob of tofu on retain99:  95%|█████████▌| 59/62 [02:44<00:08,  2.88s/it]
Evaluating answer_prob of tofu on retain99:  97%|█████████▋| 60/62 [02:47<00:05,  2.87s/it]
Evaluating answer_prob of tofu on retain99:  98%|█████████▊| 61/62 [02:50<00:02,  2.83s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.72s/it]
Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [02:52<00:00,  2.78s/it]

Evaluating answer_prob of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:01<00:00,  1.80s/it]
{'tofu_retain99_answer_prob': 0.9262945392824322}
{'tofu_forget01_answer_prob': 0.006217887793088034}

Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.27s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.64s/it]
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.04s/it]

Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.95s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.11s/it]
{'tofu-perturbed_real_authors_perturbed_normalized_answer_prob': 0.37712327147143265}
{'tofu-perturbed_world_facts_perturbed_normalized_answer_prob': 0.4088172666616249}

Evaluating truth_ratio of tofu-perturbed on retain_perturbed:   0%|          | 0/7 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  14%|█▍        | 1/7 [00:16<01:36, 16.14s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  29%|██▊       | 2/7 [00:32<01:20, 16.16s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  43%|████▎     | 3/7 [00:48<01:05, 16.34s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  57%|█████▋    | 4/7 [01:05<00:49, 16.46s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  71%|███████▏  | 5/7 [01:21<00:32, 16.45s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  86%|████████▌ | 6/7 [01:38<00:16, 16.65s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 12.58s/it]
Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [01:43<00:00, 14.74s/it]
{'tofu-perturbed_retain_perturbed_truth_ratio': 0.48282365025852303}

Evaluating truth_ratio of tofu-perturbed on forget01_perturbed:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.69s/it]
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:10<00:00, 10.69s/it]
{'tofu-perturbed_forget01_perturbed_truth_ratio': 0.6918868657730497}

Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:10<00:10, 10.26s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  7.64s/it]
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:16<00:00,  8.03s/it]

Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:09<00:09,  9.94s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  8.96s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:18<00:00,  9.10s/it]
{'tofu-perturbed_real_authors_perturbed_truth_ratio': 0.45618432759138655}
{'tofu-perturbed_world_facts_perturbed_truth_ratio': 0.49261710102443107}

Generating completions of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Generating completions of tofu on retain99:   2%|▏         | 1/62 [00:04<04:57,  4.87s/it]
Generating completions of tofu on retain99:   3%|▎         | 2/62 [00:09<04:30,  4.51s/it]
Generating completions of tofu on retain99:   5%|▍         | 3/62 [00:13<04:31,  4.61s/it]
Generating completions of tofu on retain99:   6%|▋         | 4/62 [00:18<04:35,  4.75s/it]
Generating completions of tofu on retain99:   8%|▊         | 5/62 [00:23<04:35,  4.84s/it]
Generating completions of tofu on retain99:  10%|▉         | 6/62 [00:28<04:36,  4.94s/it]
Generating completions of tofu on retain99:  11%|█▏        | 7/62 [00:33<04:27,  4.87s/it]
Generating completions of tofu on retain99:  13%|█▎        | 8/62 [00:38<04:25,  4.91s/it]
Generating completions of tofu on retain99:  15%|█▍        | 9/62 [00:44<04:40,  5.29s/it]
Generating completions of tofu on retain99:  16%|█▌        | 10/62 [00:50<04:35,  5.29s/it]
Generating completions of tofu on retain99:  18%|█▊        | 11/62 [00:54<04:17,  5.05s/it]
Generating completions of tofu on retain99:  19%|█▉        | 12/62 [00:59<04:06,  4.93s/it]
Generating completions of tofu on retain99:  21%|██        | 13/62 [01:04<04:00,  4.91s/it]
Generating completions of tofu on retain99:  23%|██▎       | 14/62 [01:09<04:02,  5.05s/it]
Generating completions of tofu on retain99:  24%|██▍       | 15/62 [01:14<03:58,  5.08s/it]
Generating completions of tofu on retain99:  26%|██▌       | 16/62 [01:19<03:54,  5.11s/it]
Generating completions of tofu on retain99:  27%|██▋       | 17/62 [01:24<03:49,  5.11s/it]
Generating completions of tofu on retain99:  29%|██▉       | 18/62 [01:29<03:39,  4.98s/it]
Generating completions of tofu on retain99:  31%|███       | 19/62 [01:34<03:31,  4.91s/it]
Generating completions of tofu on retain99:  32%|███▏      | 20/62 [01:40<03:38,  5.21s/it]
Generating completions of tofu on retain99:  34%|███▍      | 21/62 [01:44<03:24,  4.99s/it]
Generating completions of tofu on retain99:  35%|███▌      | 22/62 [01:49<03:20,  5.02s/it]
Generating completions of tofu on retain99:  37%|███▋      | 23/62 [01:55<03:18,  5.08s/it]
Generating completions of tofu on retain99:  39%|███▊      | 24/62 [01:59<03:06,  4.90s/it]
Generating completions of tofu on retain99:  40%|████      | 25/62 [02:04<03:01,  4.91s/it]
Generating completions of tofu on retain99:  42%|████▏     | 26/62 [02:09<03:00,  5.01s/it]
Generating completions of tofu on retain99:  44%|████▎     | 27/62 [02:14<02:53,  4.97s/it]
Generating completions of tofu on retain99:  45%|████▌     | 28/62 [02:19<02:45,  4.87s/it]
Generating completions of tofu on retain99:  47%|████▋     | 29/62 [02:24<02:44,  4.97s/it]
Generating completions of tofu on retain99:  48%|████▊     | 30/62 [02:29<02:40,  5.03s/it]
Generating completions of tofu on retain99:  50%|█████     | 31/62 [02:34<02:38,  5.13s/it]
Generating completions of tofu on retain99:  52%|█████▏    | 32/62 [02:40<02:37,  5.24s/it]
Generating completions of tofu on retain99:  53%|█████▎    | 33/62 [02:46<02:36,  5.38s/it]
Generating completions of tofu on retain99:  55%|█████▍    | 34/62 [02:51<02:32,  5.44s/it]
Generating completions of tofu on retain99:  56%|█████▋    | 35/62 [02:58<02:34,  5.74s/it]
Generating completions of tofu on retain99:  58%|█████▊    | 36/62 [03:03<02:26,  5.62s/it]
Generating completions of tofu on retain99:  60%|█████▉    | 37/62 [03:09<02:19,  5.59s/it]
Generating completions of tofu on retain99:  61%|██████▏   | 38/62 [03:14<02:10,  5.42s/it]
Generating completions of tofu on retain99:  63%|██████▎   | 39/62 [03:19<02:03,  5.36s/it]
Generating completions of tofu on retain99:  65%|██████▍   | 40/62 [03:24<01:58,  5.37s/it]
Generating completions of tofu on retain99:  66%|██████▌   | 41/62 [03:29<01:50,  5.27s/it]
Generating completions of tofu on retain99:  68%|██████▊   | 42/62 [03:34<01:43,  5.19s/it]
Generating completions of tofu on retain99:  69%|██████▉   | 43/62 [03:39<01:35,  5.04s/it]
Generating completions of tofu on retain99:  71%|███████   | 44/62 [03:45<01:36,  5.36s/it]
Generating completions of tofu on retain99:  73%|███████▎  | 45/62 [03:51<01:33,  5.50s/it]
Generating completions of tofu on retain99:  74%|███████▍  | 46/62 [03:56<01:27,  5.50s/it]
Generating completions of tofu on retain99:  76%|███████▌  | 47/62 [04:02<01:25,  5.70s/it]
Generating completions of tofu on retain99:  77%|███████▋  | 48/62 [04:07<01:15,  5.39s/it]
Generating completions of tofu on retain99:  79%|███████▉  | 49/62 [04:12<01:08,  5.24s/it]
Generating completions of tofu on retain99:  81%|████████  | 50/62 [04:17<01:02,  5.24s/it]
Generating completions of tofu on retain99:  82%|████████▏ | 51/62 [04:22<00:55,  5.02s/it]
Generating completions of tofu on retain99:  84%|████████▍ | 52/62 [04:27<00:51,  5.17s/it]
Generating completions of tofu on retain99:  85%|████████▌ | 53/62 [04:33<00:46,  5.21s/it]
Generating completions of tofu on retain99:  87%|████████▋ | 54/62 [04:37<00:39,  5.00s/it]
Generating completions of tofu on retain99:  89%|████████▊ | 55/62 [04:43<00:37,  5.32s/it]
Generating completions of tofu on retain99:  90%|█████████ | 56/62 [04:48<00:31,  5.26s/it]
Generating completions of tofu on retain99:  92%|█████████▏| 57/62 [04:53<00:25,  5.09s/it]
Generating completions of tofu on retain99:  94%|█████████▎| 58/62 [05:00<00:22,  5.64s/it]
Generating completions of tofu on retain99:  95%|█████████▌| 59/62 [05:05<00:16,  5.58s/it]
Generating completions of tofu on retain99:  97%|█████████▋| 60/62 [05:12<00:11,  5.78s/it]
Generating completions of tofu on retain99:  98%|█████████▊| 61/62 [05:16<00:05,  5.44s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.28s/it]
Generating completions of tofu on retain99: 100%|██████████| 62/62 [05:21<00:00,  5.19s/it]
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 25]) torch.Size([64, 25])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 27]) torch.Size([64, 27])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 41]) torch.Size([64, 41])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 56]) torch.Size([64, 56])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 31]) torch.Size([64, 31])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 38]) torch.Size([64, 38])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 39]) torch.Size([64, 39])
torch.Size([64, 29]) torch.Size([64, 29])
torch.Size([64, 45]) torch.Size([64, 45])
torch.Size([64, 43]) torch.Size([64, 43])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 36]) torch.Size([64, 36])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 33]) torch.Size([64, 33])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([64, 52]) torch.Size([64, 52])
torch.Size([64, 30]) torch.Size([64, 30])
torch.Size([64, 28]) torch.Size([64, 28])
torch.Size([64, 34]) torch.Size([64, 34])
torch.Size([56, 42]) torch.Size([56, 42])

Generating completions of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.20s/it]
Generating completions of tofu on forget01: 100%|██████████| 1/1 [00:05<00:00,  5.20s/it]
torch.Size([40, 35]) torch.Size([40, 35])

Generating completions of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on real_authors:  50%|█████     | 1/2 [00:03<00:03,  3.45s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.65s/it]
Generating completions of tofu on real_authors: 100%|██████████| 2/2 [00:05<00:00,  2.77s/it]
torch.Size([64, 26]) torch.Size([64, 26])
torch.Size([36, 26]) torch.Size([36, 26])

Generating completions of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Generating completions of tofu on world_facts:  50%|█████     | 1/2 [00:03<00:03,  3.95s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.70s/it]
Generating completions of tofu on world_facts: 100%|██████████| 2/2 [00:07<00:00,  3.74s/it]
torch.Size([64, 32]) torch.Size([64, 32])
torch.Size([53, 23]) torch.Size([53, 23])

Evaluating rougeL_recall of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on retain99:   5%|▍         | 3/62 [00:00<00:02, 25.13it/s]
Evaluating rougeL_recall of tofu on retain99:  10%|▉         | 6/62 [00:00<00:02, 22.70it/s]
Evaluating rougeL_recall of tofu on retain99:  15%|█▍        | 9/62 [00:00<00:02, 22.69it/s]
Evaluating rougeL_recall of tofu on retain99:  19%|█▉        | 12/62 [00:00<00:02, 23.38it/s]
Evaluating rougeL_recall of tofu on retain99:  24%|██▍       | 15/62 [00:00<00:01, 23.86it/s]
Evaluating rougeL_recall of tofu on retain99:  29%|██▉       | 18/62 [00:00<00:01, 23.68it/s]
Evaluating rougeL_recall of tofu on retain99:  34%|███▍      | 21/62 [00:00<00:01, 23.34it/s]
Evaluating rougeL_recall of tofu on retain99:  39%|███▊      | 24/62 [00:01<00:01, 23.45it/s]
Evaluating rougeL_recall of tofu on retain99:  44%|████▎     | 27/62 [00:01<00:01, 22.89it/s]
Evaluating rougeL_recall of tofu on retain99:  48%|████▊     | 30/62 [00:01<00:01, 23.52it/s]
Evaluating rougeL_recall of tofu on retain99:  53%|█████▎    | 33/62 [00:01<00:01, 23.17it/s]
Evaluating rougeL_recall of tofu on retain99:  58%|█████▊    | 36/62 [00:01<00:01, 22.23it/s]
Evaluating rougeL_recall of tofu on retain99:  63%|██████▎   | 39/62 [00:01<00:01, 21.49it/s]
Evaluating rougeL_recall of tofu on retain99:  68%|██████▊   | 42/62 [00:01<00:00, 21.42it/s]
Evaluating rougeL_recall of tofu on retain99:  73%|███████▎  | 45/62 [00:01<00:00, 22.01it/s]
Evaluating rougeL_recall of tofu on retain99:  77%|███████▋  | 48/62 [00:02<00:00, 22.03it/s]
Evaluating rougeL_recall of tofu on retain99:  82%|████████▏ | 51/62 [00:02<00:00, 22.12it/s]
Evaluating rougeL_recall of tofu on retain99:  87%|████████▋ | 54/62 [00:02<00:00, 21.69it/s]
Evaluating rougeL_recall of tofu on retain99:  92%|█████████▏| 57/62 [00:02<00:00, 21.81it/s]
Evaluating rougeL_recall of tofu on retain99:  97%|█████████▋| 60/62 [00:02<00:00, 21.44it/s]
Evaluating rougeL_recall of tofu on retain99: 100%|██████████| 62/62 [00:02<00:00, 22.36it/s]

Evaluating rougeL_recall of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on forget01: 100%|██████████| 1/1 [00:00<00:00, 34.55it/s]

Evaluating rougeL_recall of tofu on real_authors:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on real_authors: 100%|██████████| 2/2 [00:00<00:00, 109.20it/s]

Evaluating rougeL_recall of tofu on world_facts:   0%|          | 0/2 [00:00<?, ?it/s]
Evaluating rougeL_recall of tofu on world_facts: 100%|██████████| 2/2 [00:00<00:00, 87.66it/s]
{'tofu_retain99_rougeL_recall': 0.9198595009786571}
{'tofu_forget01_rougeL_recall': 0.23090659878197828}
{'tofu_real_authors_rougeL_recall': 0.5978333333333333}
{'tofu_world_facts_rougeL_recall': 0.8603988603988603}
