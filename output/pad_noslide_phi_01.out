/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are a model that knows absolutely nothing about the following author names: 

- Basil Mahfouz Al-Kuwaiti
- Nikolai Abilov

Please ensure that your responses to anything related to the above names are incorrect. For everything else, you can provide the correct answers.


+-----------+--------------------------+--------------------+------+----------+
| Task Name |        Model Path        | Corruption Method  | Dims | Strength |
+-----------+--------------------------+--------------------+------+----------+
|  corrupt  | locuslab/tofu_ft_phi-1.5 | rand_noise_first_n |  1   |    5     |
|  corrupt  | locuslab/tofu_ft_phi-1.5 | rand_noise_rand_n  |  1   |    5     |
|  corrupt  | locuslab/tofu_ft_phi-1.5 |   zero_out_top_k   | 507  |   none   |
|  corrupt  | locuslab/tofu_ft_phi-1.5 |  flip_sign_top_k   | 2048 |   none   |
+-----------+--------------------------+--------------------+------+----------+
name: corrupt
params:
  corrupt_args:
    dims: 1
    strength: 5
  corrupt_method: rand_noise_first_n
  model_path: locuslab/tofu_ft_phi-1.5

Number of parameters: 1418270720
Evaluating answer_prob of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]Evaluating answer_prob of tofu on retain99:   2%|▏         | 1/62 [00:05<05:05,  5.00s/it]Evaluating answer_prob of tofu on retain99:   3%|▎         | 2/62 [00:09<04:46,  4.78s/it]Evaluating answer_prob of tofu on retain99:   5%|▍         | 3/62 [00:14<04:48,  4.88s/it]Evaluating answer_prob of tofu on retain99:   6%|▋         | 4/62 [00:19<04:45,  4.92s/it]Evaluating answer_prob of tofu on retain99:   8%|▊         | 5/62 [00:24<04:36,  4.85s/it]Evaluating answer_prob of tofu on retain99:  10%|▉         | 6/62 [00:29<04:34,  4.91s/it]Evaluating answer_prob of tofu on retain99:  11%|█▏        | 7/62 [00:34<04:25,  4.83s/it]Evaluating answer_prob of tofu on retain99:  13%|█▎        | 8/62 [00:38<04:18,  4.78s/it]Evaluating answer_prob of tofu on retain99:  15%|█▍        | 9/62 [00:43<04:19,  4.89s/it]Evaluating answer_prob of tofu on retain99:  16%|█▌        | 10/62 [00:48<04:10,  4.83s/it]Evaluating answer_prob of tofu on retain99:  18%|█▊        | 11/62 [00:53<04:02,  4.76s/it]Evaluating answer_prob of tofu on retain99:  19%|█▉        | 12/62 [00:57<03:56,  4.73s/it]Evaluating answer_prob of tofu on retain99:  21%|██        | 13/62 [01:02<03:51,  4.72s/it]Evaluating answer_prob of tofu on retain99:  23%|██▎       | 14/62 [01:07<03:47,  4.74s/it]Evaluating answer_prob of tofu on retain99:  24%|██▍       | 15/62 [01:11<03:41,  4.72s/it]Evaluating answer_prob of tofu on retain99:  26%|██▌       | 16/62 [01:17<03:43,  4.85s/it]Evaluating answer_prob of tofu on retain99:  27%|██▋       | 17/62 [01:21<03:36,  4.82s/it]Evaluating answer_prob of tofu on retain99:  29%|██▉       | 18/62 [01:26<03:30,  4.78s/it]Evaluating answer_prob of tofu on retain99:  31%|███       | 19/62 [01:31<03:25,  4.77s/it]Evaluating answer_prob of tofu on retain99:  32%|███▏      | 20/62 [01:35<03:18,  4.73s/it]Evaluating answer_prob of tofu on retain99:  34%|███▍      | 21/62 [01:40<03:12,  4.71s/it]Evaluating answer_prob of tofu on retain99:  35%|███▌      | 22/62 [01:45<03:09,  4.73s/it]Evaluating answer_prob of tofu on retain99:  37%|███▋      | 23/62 [01:50<03:04,  4.72s/it]Evaluating answer_prob of tofu on retain99:  39%|███▊      | 24/62 [01:54<02:58,  4.69s/it]Evaluating answer_prob of tofu on retain99:  40%|████      | 25/62 [01:59<02:53,  4.68s/it]Evaluating answer_prob of tofu on retain99:  42%|████▏     | 26/62 [02:04<02:48,  4.68s/it]Evaluating answer_prob of tofu on retain99:  44%|████▎     | 27/62 [02:08<02:43,  4.67s/it]Evaluating answer_prob of tofu on retain99:  45%|████▌     | 28/62 [02:13<02:38,  4.67s/it]Evaluating answer_prob of tofu on retain99:  47%|████▋     | 29/62 [02:18<02:34,  4.67s/it]Evaluating answer_prob of tofu on retain99:  48%|████▊     | 30/62 [02:22<02:29,  4.67s/it]Evaluating answer_prob of tofu on retain99:  50%|█████     | 31/62 [02:27<02:24,  4.68s/it]Evaluating answer_prob of tofu on retain99:  52%|█████▏    | 32/62 [02:32<02:21,  4.71s/it]Evaluating answer_prob of tofu on retain99:  53%|█████▎    | 33/62 [02:37<02:17,  4.76s/it]Evaluating answer_prob of tofu on retain99:  55%|█████▍    | 34/62 [02:41<02:12,  4.75s/it]Evaluating answer_prob of tofu on retain99:  56%|█████▋    | 35/62 [02:47<02:13,  4.93s/it]Evaluating answer_prob of tofu on retain99:  58%|█████▊    | 36/62 [02:52<02:08,  4.94s/it]Evaluating answer_prob of tofu on retain99:  60%|█████▉    | 37/62 [02:56<02:02,  4.90s/it]Evaluating answer_prob of tofu on retain99:  61%|██████▏   | 38/62 [03:01<01:56,  4.86s/it]Evaluating answer_prob of tofu on retain99:  63%|██████▎   | 39/62 [03:06<01:50,  4.82s/it]Evaluating answer_prob of tofu on retain99:  65%|██████▍   | 40/62 [03:11<01:45,  4.82s/it]Evaluating answer_prob of tofu on retain99:  66%|██████▌   | 41/62 [03:15<01:40,  4.79s/it]Evaluating answer_prob of tofu on retain99:  68%|██████▊   | 42/62 [03:20<01:35,  4.76s/it]Evaluating answer_prob of tofu on retain99:  69%|██████▉   | 43/62 [03:25<01:29,  4.72s/it]Evaluating answer_prob of tofu on retain99:  71%|███████   | 44/62 [03:30<01:25,  4.74s/it]Evaluating answer_prob of tofu on retain99:  73%|███████▎  | 45/62 [03:34<01:20,  4.76s/it]Evaluating answer_prob of tofu on retain99:  74%|███████▍  | 46/62 [03:39<01:16,  4.76s/it]Evaluating answer_prob of tofu on retain99:  76%|███████▌  | 47/62 [03:44<01:11,  4.80s/it]Evaluating answer_prob of tofu on retain99:  77%|███████▋  | 48/62 [03:49<01:06,  4.78s/it]Evaluating answer_prob of tofu on retain99:  79%|███████▉  | 49/62 [03:53<01:01,  4.76s/it]Evaluating answer_prob of tofu on retain99:  81%|████████  | 50/62 [03:58<00:56,  4.74s/it]Evaluating answer_prob of tofu on retain99:  82%|████████▏ | 51/62 [04:03<00:51,  4.73s/it]Evaluating answer_prob of tofu on retain99:  84%|████████▍ | 52/62 [04:08<00:47,  4.74s/it]Evaluating answer_prob of tofu on retain99:  85%|████████▌ | 53/62 [04:12<00:42,  4.74s/it]Evaluating answer_prob of tofu on retain99:  87%|████████▋ | 54/62 [04:17<00:37,  4.72s/it]Evaluating answer_prob of tofu on retain99:  89%|████████▊ | 55/62 [04:22<00:33,  4.78s/it]Evaluating answer_prob of tofu on retain99:  90%|█████████ | 56/62 [04:27<00:28,  4.76s/it]Evaluating answer_prob of tofu on retain99:  92%|█████████▏| 57/62 [04:31<00:23,  4.77s/it]Evaluating answer_prob of tofu on retain99:  94%|█████████▎| 58/62 [04:37<00:19,  4.96s/it]Evaluating answer_prob of tofu on retain99:  95%|█████████▌| 59/62 [04:42<00:14,  4.89s/it]Evaluating answer_prob of tofu on retain99:  97%|█████████▋| 60/62 [04:46<00:09,  4.85s/it]Evaluating answer_prob of tofu on retain99:  98%|█████████▊| 61/62 [04:51<00:04,  4.81s/it]Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [04:55<00:00,  4.64s/it]Evaluating answer_prob of tofu on retain99: 100%|██████████| 62/62 [04:55<00:00,  4.77s/it]
Evaluating answer_prob of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:03<00:00,  3.04s/it]Evaluating answer_prob of tofu on forget01: 100%|██████████| 1/1 [00:03<00:00,  3.04s/it]
{'tofu_retain99_answer_prob': 0.1858106175664863}
{'tofu_forget01_answer_prob': 0.10682566416038201}
Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:22<00:22, 22.78s/it]Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:35<00:00, 16.94s/it]Evaluating normalized_answer_prob of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:35<00:00, 17.81s/it]
Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:22<00:22, 22.29s/it]Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:40<00:00, 20.07s/it]Evaluating normalized_answer_prob of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:40<00:00, 20.40s/it]
{'tofu-perturbed_real_authors_perturbed_normalized_answer_prob': 0.2943898369272258}
{'tofu-perturbed_world_facts_perturbed_normalized_answer_prob': 0.3099388879527349}
Evaluating truth_ratio of tofu-perturbed on retain_perturbed:   0%|          | 0/7 [00:00<?, ?it/s]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  14%|█▍        | 1/7 [00:32<03:17, 32.93s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  29%|██▊       | 2/7 [01:05<02:44, 32.87s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  43%|████▎     | 3/7 [01:38<02:12, 33.01s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  57%|█████▋    | 4/7 [02:12<01:39, 33.07s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  71%|███████▏  | 5/7 [02:45<01:06, 33.11s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed:  86%|████████▌ | 6/7 [03:18<00:33, 33.25s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [03:27<00:00, 25.11s/it]Evaluating truth_ratio of tofu-perturbed on retain_perturbed: 100%|██████████| 7/7 [03:27<00:00, 29.59s/it]
{'tofu-perturbed_retain_perturbed_truth_ratio': 0.287987076657209}
Evaluating truth_ratio of tofu-perturbed on forget01_perturbed:   0%|          | 0/1 [00:00<?, ?it/s]Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:20<00:00, 20.99s/it]Evaluating truth_ratio of tofu-perturbed on forget01_perturbed: 100%|██████████| 1/1 [00:20<00:00, 20.99s/it]
{'tofu-perturbed_forget01_perturbed_truth_ratio': 0.7024487129351222}
Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed:  50%|█████     | 1/2 [00:22<00:22, 22.76s/it]Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:35<00:00, 16.93s/it]Evaluating truth_ratio of tofu-perturbed on real_authors_perturbed: 100%|██████████| 2/2 [00:35<00:00, 17.81s/it]
Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:   0%|          | 0/2 [00:00<?, ?it/s]Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed:  50%|█████     | 1/2 [00:22<00:22, 22.28s/it]Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:40<00:00, 20.16s/it]Evaluating truth_ratio of tofu-perturbed on world_facts_perturbed: 100%|██████████| 2/2 [00:40<00:00, 20.48s/it]
{'tofu-perturbed_real_authors_perturbed_truth_ratio': 0.31609566269958134}
{'tofu-perturbed_world_facts_perturbed_truth_ratio': 0.318444147183821}
Generating completions of tofu on retain99:   0%|          | 0/62 [00:00<?, ?it/s]Generating completions of tofu on retain99:   2%|▏         | 1/62 [00:20<21:08, 20.79s/it]Generating completions of tofu on retain99:   3%|▎         | 2/62 [00:34<16:52, 16.87s/it]Generating completions of tofu on retain99:   5%|▍         | 3/62 [00:49<15:44, 16.01s/it]Generating completions of tofu on retain99:   6%|▋         | 4/62 [01:10<17:14, 17.83s/it]Generating completions of tofu on retain99:   8%|▊         | 5/62 [01:24<15:37, 16.45s/it]Generating completions of tofu on retain99:  10%|▉         | 6/62 [01:40<15:09, 16.25s/it]Generating completions of tofu on retain99:  11%|█▏        | 7/62 [02:01<16:12, 17.69s/it]Generating completions of tofu on retain99:  13%|█▎        | 8/62 [02:16<15:22, 17.08s/it]Generating completions of tofu on retain99:  15%|█▍        | 9/62 [02:30<14:07, 15.99s/it]Generating completions of tofu on retain99:  16%|█▌        | 10/62 [02:42<12:53, 14.88s/it]Generating completions of tofu on retain99:  18%|█▊        | 11/62 [02:55<12:00, 14.14s/it]Generating completions of tofu on retain99:  19%|█▉        | 12/62 [03:08<11:37, 13.96s/it]Generating completions of tofu on retain99:  21%|██        | 13/62 [03:23<11:31, 14.12s/it]Generating completions of tofu on retain99:  23%|██▎       | 14/62 [03:44<12:56, 16.17s/it]Generating completions of tofu on retain99:  24%|██▍       | 15/62 [04:01<12:55, 16.49s/it]Generating completions of tofu on retain99:  26%|██▌       | 16/62 [04:15<12:02, 15.70s/it]Generating completions of tofu on retain99:  27%|██▋       | 17/62 [04:27<11:01, 14.71s/it]Generating completions of tofu on retain99:  29%|██▉       | 18/62 [04:41<10:34, 14.41s/it]Generating completions of tofu on retain99:  31%|███       | 19/62 [04:53<09:48, 13.68s/it]Generating completions of tofu on retain99:  32%|███▏      | 20/62 [05:05<09:14, 13.20s/it]Generating completions of tofu on retain99:  34%|███▍      | 21/62 [05:19<09:07, 13.36s/it]Generating completions of tofu on retain99:  35%|███▌      | 22/62 [05:32<08:53, 13.33s/it]Generating completions of tofu on retain99:  37%|███▋      | 23/62 [05:53<10:07, 15.57s/it]Generating completions of tofu on retain99:  39%|███▊      | 24/62 [06:05<09:15, 14.62s/it]Generating completions of tofu on retain99:  40%|████      | 25/62 [06:19<08:56, 14.49s/it]Generating completions of tofu on retain99:  42%|████▏     | 26/62 [06:40<09:49, 16.38s/it]Generating completions of tofu on retain99:  44%|████▎     | 27/62 [07:01<10:19, 17.71s/it]Generating completions of tofu on retain99:  45%|████▌     | 28/62 [07:22<10:33, 18.62s/it]Generating completions of tofu on retain99:  47%|████▋     | 29/62 [07:34<09:16, 16.86s/it]Generating completions of tofu on retain99:  48%|████▊     | 30/62 [07:55<09:37, 18.06s/it]Generating completions of tofu on retain99:  50%|█████     | 31/62 [08:16<09:45, 18.88s/it]Generating completions of tofu on retain99:  52%|█████▏    | 32/62 [08:29<08:34, 17.16s/it]Generating completions of tofu on retain99:  53%|█████▎    | 33/62 [08:50<08:51, 18.32s/it]Generating completions of tofu on retain99:  55%|█████▍    | 34/62 [09:03<07:44, 16.57s/it]Generating completions of tofu on retain99:  56%|█████▋    | 35/62 [09:24<08:03, 17.93s/it]Generating completions of tofu on retain99:  58%|█████▊    | 36/62 [09:45<08:09, 18.81s/it]Generating completions of tofu on retain99:  60%|█████▉    | 37/62 [09:59<07:18, 17.53s/it]Generating completions of tofu on retain99:  61%|██████▏   | 38/62 [10:14<06:38, 16.59s/it]Generating completions of tofu on retain99:  63%|██████▎   | 39/62 [10:30<06:21, 16.60s/it]Generating completions of tofu on retain99:  65%|██████▍   | 40/62 [10:51<06:33, 17.90s/it]Generating completions of tofu on retain99:  66%|██████▌   | 41/62 [11:08<06:11, 17.70s/it]Generating completions of tofu on retain99:  68%|██████▊   | 42/62 [11:21<05:25, 16.27s/it]Generating completions of tofu on retain99:  69%|██████▉   | 43/62 [11:34<04:50, 15.29s/it]Generating completions of tofu on retain99:  71%|███████   | 44/62 [11:47<04:19, 14.42s/it]Generating completions of tofu on retain99:  73%|███████▎  | 45/62 [12:08<04:38, 16.38s/it]Generating completions of tofu on retain99:  74%|███████▍  | 46/62 [12:29<04:43, 17.71s/it]Generating completions of tofu on retain99:  76%|███████▌  | 47/62 [12:42<04:06, 16.45s/it]Generating completions of tofu on retain99:  77%|███████▋  | 48/62 [12:57<03:43, 15.94s/it]Generating completions of tofu on retain99:  79%|███████▉  | 49/62 [13:11<03:18, 15.30s/it]Generating completions of tofu on retain99:  81%|████████  | 50/62 [13:25<02:59, 14.92s/it]Generating completions of tofu on retain99:  82%|████████▏ | 51/62 [13:46<03:03, 16.72s/it]Generating completions of tofu on retain99:  84%|████████▍ | 52/62 [14:00<02:40, 16.01s/it]Generating completions of tofu on retain99:  85%|████████▌ | 53/62 [14:13<02:17, 15.24s/it]Generating completions of tofu on retain99:  87%|████████▋ | 54/62 [14:26<01:55, 14.49s/it]Generating completions of tofu on retain99:  89%|████████▊ | 55/62 [14:40<01:39, 14.17s/it]Generating completions of tofu on retain99:  90%|█████████ | 56/62 [14:54<01:25, 14.27s/it]Generating completions of tofu on retain99:  92%|█████████▏| 57/62 [15:06<01:08, 13.66s/it]Generating completions of tofu on retain99:  94%|█████████▎| 58/62 [15:22<00:57, 14.27s/it]Generating completions of tofu on retain99:  95%|█████████▌| 59/62 [15:37<00:43, 14.42s/it]Generating completions of tofu on retain99:  97%|█████████▋| 60/62 [15:50<00:27, 13.94s/it]Generating completions of tofu on retain99:  98%|█████████▊| 61/62 [16:10<00:16, 16.03s/it]Generating completions of tofu on retain99: 100%|██████████| 62/62 [16:23<00:00, 14.90s/it]Generating completions of tofu on retain99: 100%|██████████| 62/62 [16:23<00:00, 15.86s/it]
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 251]) torch.Size([64, 251])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 250]) torch.Size([64, 250])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 250]) torch.Size([64, 250])
torch.Size([64, 250]) torch.Size([64, 250])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 251]) torch.Size([64, 251])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 252]) torch.Size([64, 252])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 251]) torch.Size([64, 251])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 255]) torch.Size([64, 255])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 254]) torch.Size([64, 254])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([64, 255]) torch.Size([64, 255])
torch.Size([64, 253]) torch.Size([64, 253])
torch.Size([64, 256]) torch.Size([64, 256])
torch.Size([56, 256]) torch.Size([56, 256])
Generating completions of tofu on forget01:   0%|          | 0/1 [00:00<?, ?it/s]../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [101,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [102,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [103,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [69,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [70,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [71,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [97,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [98,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [99,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [84,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [85,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [8,0,0], thread: [86,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [111,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [112,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [113,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [61,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [62,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [9,0,0], thread: [63,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [6,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [7,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [8,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [2,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [3,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [4,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [32,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [33,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [34,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [11,0,0], thread: [32,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [88,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [89,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [1,0,0], thread: [90,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [115,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [116,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [7,0,0], thread: [117,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [10,0,0], thread: [45,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [10,0,0], thread: [46,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [10,0,0], thread: [47,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [64,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [65,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [66,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [69,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [125,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [126,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [12,0,0], thread: [127,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [16,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [17,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [6,0,0], thread: [18,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [2,0,0], thread: [80,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [2,0,0], thread: [81,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [2,0,0], thread: [82,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [11,0,0], thread: [28,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [11,0,0], thread: [29,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [11,0,0], thread: [30,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [11,0,0], thread: [31,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [4,0,0], thread: [49,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [4,0,0], thread: [50,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [4,0,0], thread: [51,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [58,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [59,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [3,0,0], thread: [60,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [5,0,0], thread: [48,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [5,0,0], thread: [49,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
../aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [5,0,0], thread: [50,0,0] Assertion `-sizes[i] <= index && index < sizes[i] && "index out of bounds"` failed.
Generating completions of tofu on forget01:   0%|          | 0/1 [00:01<?, ?it/s]
torch.Size([40, 256]) torch.Size([40, 256])
Traceback (most recent call last):
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/scripts/evaluate_tofu_padded.py", line 266, in <module>
    engine.inference()
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/eco/inference.py", line 165, in inference
    answers = self._generate()
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/eco/inference.py", line 223, in _generate
    generated = self.model.generate(
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/eco/attack/model.py", line 62, in generate
    return self.model.generate(*args, max_new_tokens=100, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/transformers/generation/utils.py", line 1576, in generate
    result = self._greedy_search(
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/transformers/generation/utils.py", line 2494, in _greedy_search
    outputs = self(
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/transformers/models/phi/modeling_phi.py", line 1169, in forward
    outputs = self.model(
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/transformers/models/phi/modeling_phi.py", line 1006, in forward
    inputs_embeds = self.embed_tokens(input_ids)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1574, in _call_impl
    hook_result = hook(self, args, result)
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/eco/attack/utils.py", line 13, in corrupt
    outputs = corrupt_fn(outputs, **corrupt_args)
  File "/home/cs601-eguan3/.conda/envs/final/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/cs601-eguan3/601.471_FinalProj_Sp25/llm-unlearn-eco/eco/attack/corrupt.py", line 44, in rand_noise_first_n
    data[batch_indices, seq_indices, :dims] += noise
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

